"use strict";var t,i,e,h,s,o,r,n,d,g,l,a,y,c,f,w,m,u,x,k,p,v,A,S,L,E,b,z,C,j,I,P,M,T,Y,X,W,R,B,D,H=390,V=8,F=19.5/9,N=[],G=[],O=[],q=[],J=0,Z=0,K=60,Q=!1,U=!1,_=!0,tt=!1,it=!1,et="",ht=!1,st=100,ot=[],rt=0,nt=!1;const dt=/^[A-Za-z0-9]*$/;var gt,lt,at,yt,ct,ft,wt,mt,ut,xt,kt,pt,vt,At=[];async function St(t=!1,i,e){try{const h=await fetch("php/rocketcat/gethighscores.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!h.ok)throw new Error(`HTTP error! Status: ${h.status}`);const s=await h.json();for(let t=0;t<s.length;t++)ot[t]=s[t];return!1,t&&async function(t,i){let e=!1,h=!1;for(let t=0;t<ot.length;t++)if(ot[t].score<i){e=!0,D=t+1;break}!e&&ot.length<100&&(e=!0,D=ot.length+1);if(!e)return!1;{let e=[t,i];try{const t=await fetch("php/rocketcat/loghighscore.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission:JSON.stringify(e)})});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);!0===await t.json()&&(h=!0,P.display=!0),!1}catch(t){!0,nt||(console.log("High scores are currently disabled."),nt=!0),console.error("An error occurred while logging high scores:",t)}}}(i,e),!0}catch(t){return!0,nt||(console.log("High scores are currently disabled."),nt=!0),console.error("An error occurred while fetching high scores:",t),!1}}let Lt=function(){let t=navigator?.userAgentData?.platform||navigator?.platform||"unknown";return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(t)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}();function Et(){document.getElementById("notice").style.display="none",Lt?(t=$(window).width(),i=$(window).height()):(t=window.innerWidth,i=window.innerHeight),t<H?i=(t=H)/F:i>t/F?i=t/F:i<H/F?(t=H,i=H/F):t=i*F,s=t/e.width,e.width=t,e.height=i,V=8*(t/H),X=e.height/12*11,window.innerWidth<window.innerHeight||document.documentElement.clientWidth<document.documentElement.clientHeight?document.getElementById("notice").style.display="block":document.getElementById("notice").style.display="none",h.webkitImageSmoothingEnabled=!1,h.mozImageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1}function bt(){Et();for(let t=0;t<N.length;t++)N[t].resize();for(let t=0;t<G.length;t++)G[t].resize();U&&M.resize(),Q?(e.removeEventListener("mousedown",q[1]),e.removeEventListener("mousedown",q[3]),e.removeEventListener("touchstart",q[4]),q.splice(1,1,I.clickListener),q.splice(3,1,C.clickListener),q.splice(4,1,C.touchListener),e.addEventListener("mousedown",q[1],!0),e.addEventListener("mousedown",q[3],!0),e.addEventListener("touchstart",q[4],{passive:!0}),e.removeEventListener("mousemove",B),e.addEventListener("mousemove",B)):(e.removeEventListener("click",O[1]),e.removeEventListener("click",O[2]),e.removeEventListener("click",O[3]),g.removeEventListener("keydown",O[4]),e.removeEventListener("click",O[5]),e.removeEventListener("click",O[6]),e.removeEventListener("mousemove",R),e.addEventListener("click",O[1]),e.addEventListener("click",O[2]),e.addEventListener("click",O[3]),g.addEventListener("keydown",O[4],!0),e.addEventListener("click",O[5]),e.addEventListener("click",O[6]),e.addEventListener("mousemove",R)),tt=!1}function zt(t,i,e,s,o){h.fillStyle=o,h.font=e+"px "+s,h.textAlign="center",h.textBaseLine="middle",h.fillText(i,t.x+t.width/2,t.y+t.height/2+e/3.5)}function Ct(t){return Math.floor(Math.random()*t)}function jt(t,i,e){var h=t.x,s=t.x+t.width,o=t.y,r=t.y+t.height;if(i>=h&&i<=s&&e>=o&&e<=r)return!0}function It(){m={color:"white",hoverColor:"orange",x:e.width/24*.25,y:e.height/12/12*2,width:e.width/24*1.5,height:e.height/12/12*8,hover:!1,resize:function(){this.x=e.width/24*.25,this.y=e.height/12/12*2,this.width=e.width/24*1.5,this.height=e.height/12/12*8},draw:function(){if(it){let t;t=this.hover?this.hoverColor:this.color,h.strokeStyle=t,h.lineWidth="1",h.beginPath(),h.roundRect(this.x,this.y,this.width,this.height,this.width/3.1415),h.stroke(),zt(this," FPSâš¡",.6*this.height,"Silkscreen",t)}}},u={color:"white",hoverColor:"orange",x:e.width/24*4,y:e.height/24*6.5,width:e.width/24*16,height:e.height/16*4,hover:!1,exited:!1,resize:function(){this.x=e.width/24*4,this.y=e.height/24*6.5,this.width=e.width/24*16,this.height=e.height/16*4},draw:function(t){!this.exited&&it&&(t.fillStyle="black",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.fill(),t.strokeStyle=this.hoverColor,t.lineWidth="2",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),t.font=.3*this.height+"px Silkscreen",t.fillStyle=this.hoverColor,t.fillText("FPS Issue Detected!",this.x+this.width/2.25,this.y+this.height/12*3.5),t.font=.2*this.height+"px Silkscreen",t.fillStyle=this.color,t.fillText("You can still play, but for optimal game",this.x+this.width/2,this.y+this.height/12*6.5),t.font=.2*this.height+"px Silkscreen",t.fillStyle=this.color,t.fillText("play, consider turning off Low Power",this.x+this.width/2,this.y+this.height/12*8.5),t.font=.2*this.height+"px Silkscreen",t.fillStyle=this.color,t.fillText("Mode, as it causes unsteady frame rate.",this.x+this.width/2,this.y+this.height/12*10.5))},clickListener:function(t){if(it)if(u.exited){jt(m,t.offsetX,t.offsetY)&&(u.exited=!1,m.hover=!1)}else{jt(x,t.offsetX,t.offsetY)&&(u.exited=!0,x.hover=!1),jt(m,t.offsetX,t.offsetY)&&(u.exited=!0,m.hover=!1)}}},x={color:"white",hoverColor:"orange",x:u.x+u.width/12*10-4,y:u.y+4,width:u.width/12*2,height:u.width/12*.5,hover:!1,resize:function(){this.x=u.x+u.width/12*10-4,this.y=u.y+4,this.width=u.width/12*2,this.height=u.width/12*.5},draw:function(t){if(!u.exited&&it){let i;i=this.hover?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="2",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,2*this.width/3.1415),t.stroke(),t.font=.8*this.height+"px Silkscreen",t.fillStyle=i,t.fillText("Close",this.x+this.width/2,this.y+this.height/10*7.25)}}},l={color:"white",x:e.width/12*1,y:e.height/12/12*2,width:e.width/12*3,height:e.height/12/12*8,resize:function(){this.x=e.width/12*1,this.y=e.height/12/12*2,this.width=e.width/12*3,this.height=e.height/12/12*8},draw:function(t){t.strokeStyle=this.color,t.lineWidth="1",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),zt(this,"Current Score: "+J.toString(),.6*this.height,"Silkscreen",this.color)}},a={color:"white",x:e.width/12*8,y:e.height/12/12*2,width:e.width/12*3,height:e.height/12/12*8,resize:function(){this.x=e.width/12*8,this.y=e.height/12/12*2,this.width=e.width/12*3,this.height=e.height/12/12*8},draw:function(t){t.strokeStyle=this.color,t.lineWidth="1",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),zt(this,"High Score: "+Z.toString(),.6*this.height,"Silkscreen",this.color)}},c={color:"black",x:0,y:e.height/24*6.5,width:e.width,height:e.height/6*2,resize:function(){this.y=e.height/24*6.5,this.width=e.width,this.height=e.height/6*2},draw:function(t){t.font=.5*this.height+"px Silkscreen",t.strokeStyle="orange",t.lineWidth=.05*e.height,t.strokeText("Rocket Cat",c.x+c.width/2,c.y+c.height/2),t.fillStyle="white",t.fillText("Rocket Cat",c.x+c.width/2,c.y+c.height/2)}},p={color:"white",hoverColor:"orange",x:e.width/24*8,y:e.height/24*3,width:e.width/24*8,height:e.height/16*1.5,hover:!1,nameEntered:!1,takingInput:!1,animationCounter:0,resize:function(){this.x=e.width/24*8,this.y=e.height/24*3,this.width=e.width/24*8,this.height=e.height/16*1.5},update:function(){et=g.value},draw:function(t){if(!ht){let i,e;i=this.hover||this.takingInput?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="2",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),e=et.length<1?"-Enter session name-":et,zt(this,e,.5*this.height,"Silkscreen",i),this.takingInput&&(this.animationCounter++,this.animationCounter<=30&&(t.lineWidth=2,t.strokeStyle="orange",t.beginPath(),t.moveTo(this.x+this.width/10*1,this.y+this.height-this.height/10*2),t.lineTo(this.x+this.width-this.width/10*1,this.y+this.height-this.height/10*2),t.stroke()),this.animationCounter>=60&&(this.animationCounter=0))}},keyListener:function(t){1==p.takingInput&&(dt.test(t.key)||t.preventDefault(),(et=g.value).length>0?p.nameEntered=!0:p.nameEntered=!1)},focusInput:function(){document.activeElement.blur(),g.tabIndex=1,g.focus(),p.takingInput=!0},blurInput:function(){p.takingInput=!1,g.tabIndex=-1,g.blur()},clickListener:function(t){let i=jt(p,t.offsetX,t.offsetY);i&&!ht?p.focusInput():i||1!=p.takingInput||p.blurInput()}},v={color:"white",hoverColor:"orange",x:e.width/24*6,y:e.height/12*7,width:e.width/24*12,height:e.height/8,hover:!1,resize:function(){this.x=e.width/24*6,this.y=e.height/12*7,this.width=e.width/24*12,this.height=e.height/8},draw:function(t){if(!ht){let i,e;i=this.hover?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="2",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,this.width/3.1415),t.stroke(),e=U?"Continue":"Start Game",zt(this,e,.5*this.height,"Silkscreen",i)}},clickListener:function(t){let i=jt(v,t.offsetX,t.offsetY);if(i&&!ht&&et.length>0&&(p.blurInput(),U||(Pt(),U=!0),Q=!0,_=!0,v.hover=!1),i&&!ht&&et.length<1){v.hover=!1;const t=document.createElement("input");t.setAttribute("type","text"),t.style.position="absolute",t.style.opacity=0,t.style.height=0,t.style.fontSize="16px",document.body.prepend(t),t.focus(),setTimeout((()=>{p.focusInput(),t.remove()}),100)}},keyListener:function(t){if((49==t.keyCode||" "==t.key||"Space"==t.code)&&(!ht&&et.length>0&&!p.takingInput&&(p.blurInput(),U||(Pt(),U=!0),Q=!0,_=!0,v.hover=!1),et.length<1)){v.hover=!1;const t=document.createElement("input");t.setAttribute("type","text"),t.style.position="absolute",t.style.opacity=0,t.style.height=0,t.style.fontSize="16px",document.body.prepend(t),t.focus(),p.focusInput(),t.remove()}13!=t.keyCode&&13!=t.key&&"Enter"!=t.code||(p.takingInput&&(document.activeElement.blur(),p.blurInput()),!ht&&et.length>0&&(p.blurInput(),U||(Pt(),U=!0),Q=!0,_=!0,v.hover=!1))}},A={color:"white",hoverColor:"orange",x:e.width/24*8,y:e.height/16*12,width:e.width/24*8,height:e.height/16*1.5,hover:!1,resize:function(){this.x=e.width/24*8,this.y=e.height/16*12,this.width=e.width/24*8,this.height=e.height/16*1.5},draw:function(t){if(!ht){let i;i=this.hover?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="2",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,this.width/3.1415),t.stroke(),zt(this,"High Scores",.5*this.height,"Silkscreen",i)}},clickListener:function(t){let i=jt(A,t.offsetX,t.offsetY);i&&!ht&&(St(),ht=!0,i=!1,A.hover=!1)}},y={color:"white",x:0,y:e.height/12*11,width:e.width,height:e.height/12,resize:function(){this.y=e.height/12*11,this.width=e.width,this.height=e.height/12},draw:function(t){t.fillStyle=this.color,t.beginPath(),t.rect(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height)),t.fill()}},f={color:"black",x:0,y:X,width:e.width,height:y.height,resize:function(){this.y=X,this.width=e.width,this.height=y.height},draw:function(){zt(this,"by Liam Fitzmaurice",Math.floor(.5*this.height),"Silkscreen",this.color)}},w={imgSize:16,x:Math.ceil(8*V),y:Math.ceil(X-2*V),width:Math.ceil(2*V),height:Math.ceil(2*V),resize:function(){this.x=Math.ceil(8*V),this.y=Math.ceil(X-2*V),this.width=Math.ceil(2*V),this.height=Math.ceil(2*V)},draw:function(t){t.drawImage(gt,32,32,w.imgSize,w.imgSize,w.x,w.y+e.height/80,w.width,w.height)}},R=function(t){if(!ht){let i=jt(v,t.offsetX,t.offsetY);v.hover=!!i;let e=jt(A,t.offsetX,t.offsetY);A.hover=!!e;let h=jt(p,t.offsetX,t.offsetY);if(p.hover=!!h,it){let i=jt(m,t.offsetX,t.offsetY);if(m.hover=!!i,!u.exited){let i=jt(x,t.offsetX,t.offsetY);x.hover=!!i}}}if(ht){let i=jt(L,t.offsetX,t.offsetY),e=jt(S,t.offsetX,t.offsetY);if(L.hover=!(!i&&e),rt>0){let i=jt(E,t.offsetX,t.offsetY);E.hover=!!i}if(rt<90){let i=jt(b,t.offsetX,t.offsetY);b.hover=!!i}}},S={color:"black",x:e.width/12*2,y:e.height/12*1,width:e.width/12*8,height:e.height/12*9,resize:function(){this.x=e.width/12*2,this.y=e.height/12*1,this.width=e.width/12*8,this.height=e.height/12*9},draw:function(t){if(ht){t.fillStyle=this.color,t.beginPath(),t.rect(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height)),t.fill(),t.lineWidth="2",t.strokeStyle="white",t.beginPath(),t.rect(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height)),t.stroke(),t.font=this.height/6*.5+"px Silkscreen",t.strokeStyle="orange",t.lineWidth=this.height/6*.05,t.strokeText("High Scores",this.x+this.width/2,this.y+this.height/12*1),t.fillStyle="white",t.fillText("High Scores",this.x+this.width/2,this.y+this.height/12*1),t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*2,this.y+this.height/12*1.5),t.lineTo(this.x+this.width/12*10,this.y+this.height/12*1.5),t.stroke();let i,e,h,s,o=this.x+this.width/12*1,r=(this.x+this.width/12*11-o)/3,n=this.y+2.5*this.height/12,d=(this.y+this.height-n)/10;for(let e=0;e<3;e++){switch(e){case 0:i="Place";break;case 1:i="Name";break;case 2:i="Score"}t.font=.8*d+"px Silkscreen",t.fillStyle="white",t.fillText(i,o+e*r+r/4+e*(r/4),n-d/4)}t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*1,n),t.lineTo(this.x+this.width/12*11,n),t.stroke();for(let i=0;i<10;i++)void 0===ot[i+rt]?(e="-",h="-"):(e=ot[i+rt].name,h=ot[i+rt].score),s=i+1+rt,i<9&&(t.strokeStyle="gray",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*1,n+(i+1)*d),t.lineTo(this.x+this.width/12*11,n+(i+1)*d),t.stroke()),t.font=.8*d+"px Silkscreen",t.fillStyle="white",t.fillText(s,o+0*r+r/4,n+(i+1)*d-d/4),t.font=.8*d+"px Silkscreen",t.fillStyle="white",t.fillText(e,o+1*r+r/4+r/4*1,n+(i+1)*d-d/4),t.strokeStyle="white",t.font=.8*d+"px Silkscreen",t.fillStyle="white",t.fillText(h,o+2*r+r/4+r/4*2,n+(i+1)*d-d/4)}},clickListener:function(t){if(ht){let i=jt(S,t.offsetX,t.offsetY);i||(ht=!1,L.hover=!1),i=jt(L,t.offsetX,t.offsetY),i&&(ht=!1,L.hover=!1),rt>0&&(i=jt(E,t.offsetX,t.offsetY),i&&(rt-=10,E.hover=!1)),rt<90&&(i=jt(b,t.offsetX,t.offsetY),i&&(rt+=10,b.hover=!1))}}},L={color:"black",x:S.x+S.width/12*10-4,y:S.y+4,width:S.width/12*2,height:S.width/12*.5,hover:!1,resize:function(){this.x=S.x+S.width/12*10-4,this.y=S.y+4,this.width=S.width/12*2,this.height=S.width/12*.5},draw:function(t){if(ht){let i;i=this.hover?"orange":"white",t.strokeStyle=i,t.lineWidth="2",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,2*this.width/3.1415),t.stroke(),t.font=.8*this.height+"px Silkscreen",t.fillStyle=i,t.fillText("Close",this.x+this.width/2,this.y+this.height/10*7.25)}},clickListener:function(t){if(ht){let i=jt(S,t.offsetX,t.offsetY);i||(ht=!1,i=!1)}}},E={color:"white",x:S.x+4,y:S.height/12*8,width:S.width/12*1-8,height:S.height/12*3-4,hover:!1,resize:function(){this.x=S.x+4,this.y=S.height/12*8,this.width=S.width/12*1-8,this.height=S.height/12*3-4},draw:function(t){if(ht&&rt>0){let i;i=this.hover?"orange":this.color,t.strokeStyle=i,t.lineWidth=2,t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,2*this.width/3.1415),t.stroke(),t.font=.4*this.height+"px Silkscreen",t.fillStyle=i,t.fillText("<",this.x+this.width/10*4.5,this.y+this.height/10*6)}}},b={color:"white",x:S.x+S.width/12*11+2,y:S.height/12*8,width:S.width/12*1-8,height:S.height/12*3-4,hover:!1,resize:function(){this.x=S.x+S.width/12*11+4,this.y=S.height/12*8,this.width=S.width/12*1-8,this.height=S.height/12*3-4},draw:function(t){if(ht&&rt<90){let i;i=this.hover?"orange":this.color,t.strokeStyle=i,t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,2*this.width/3.1415),t.stroke(),t.font=.4*this.height+"px Silkscreen",t.fillStyle=i,t.fillText(">",this.x+this.width/10*5.5,this.y+this.height/10*6)}}},O.push(v.keyListener,v.clickListener,A.clickListener,S.clickListener,p.keyListener,p.clickListener,u.clickListener),N.splice(0,0,y,l,a,c,f,p,v,A,w,u,x,S,L,E,b,m),window.addEventListener("resize",bt,!1),window.addEventListener("orientationchange",bt,!1),window.requestAnimationFrame(Tt)}function Pt(){j={x:0,y:e.height/12,width:e.width,height:e.height,resize:function(){this.y=e.height/12,this.width=e.width,this.height=e.height}},z={color:"white",x:e.width/12*5,y:e.height/12/12*2,width:e.width/12*2,height:e.height/12/12*8,resize:function(){this.x=e.width/12*5,this.y=e.height/12/12*2,this.width=e.width/12*2,this.height=e.height/12/12*8},draw:function(t){t.strokeStyle=this.color,t.lineWidth="1",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),zt(this,et,.6*this.height,"Silkscreen",this.color)}},C={imgSize:16,x:Math.floor(8*V),y:Math.floor(X-2*V),width:Math.floor(2*V),height:Math.floor(2*V),walkAnimationCounter:0,walking:!0,walkPhase:0,jumping:!1,landed:!0,jumpAnimationCounter:0,jumpVelocity:e.height/3/12,jumpGravity:e.height/3/33/20,midAir:!1,jumpDescending:!1,usedRocket:!1,flyingAnimationCounter:0,flyingPhase:0,dead:!1,deadAnimationCounter:0,deadDirection:0,deadLocationX:0,deadLocationY:0,resize:function(){this.x=Math.floor(8*V),this.y=Math.floor(this.y*s),this.width=Math.floor(2*V),this.height=Math.floor(2*V),this.jumpVelocity=this.jumpVelocity*s,this.jumpGravity=e.height/3/33/20,M.resize()},reset:function(){W.reset(),this.x=8*V,this.y=X-2*V,this.walkAnimationCounter=0,this.walking=!0,this.walkPhase=0,this.jumping=!1,this.landed=!0,this.jumpAnimationCounter=0,this.jumpVelocity=e.height/3/12,this.jumpGravity=e.height/3/33/20,this.midAir=!1,this.jumpDescending=!1,this.usedRocket=!1,this.flying=!1,this.flyingAnimationCounter=0,this.flyingPhase=0,this.dead=!1,this.deadAnimationCounter=0,this.deadLocationX=0,this.deadLocationY=0,J=0,st=100,P.display=!1,P.timer=0},update:function(){this.dead&&(st=0,this.deadAnimationCounter++),this.walking&&!this.dead?(this.walkAnimationCounter+=1*d,this.walkAnimationCounter>=15&&(this.walkAnimationCounter=0,5==this.walkPhase?this.walkPhase=0:this.walkPhase++)):this.flying&&!this.dead?(st<150&&(st+=1*d),this.jumpVelocity<0&&(this.jumpVelocity=0),0==this.usedRocket&&(this.usedRocket=!0),this.flyingAnimationCounter+=1*d,this.flyingAnimationCounter>=5&&(this.flyingAnimationCounter=0,3==this.flyingPhase?this.flyingPhase=0:this.flyingPhase++)):this.jumping&&!this.dead&&(this.usedRocket||100==st||(st=100),this.jumpVelocity<0&&(this.jumpDescending=!0),this.jumpVelocity>0&&this.jumpDescending&&(this.jumpVelocity=0),this.midAir=!0,this.jumpVelocity=this.jumpVelocity-this.jumpGravity*d,this.y=this.y-this.jumpVelocity*d,this.y>=X-2*V&&this.midAir&&this.jumpDescending&&(st=100,this.y=X-2*V,this.jumping=!1,this.jumpDescending=!1,this.midAir=!1,this.walking=!0,this.jumpVelocity=e.height/3/12,this.usedRocket=!1))},draw:function(t){if(this.dead)C.x+2*C.width>0&&(this.jumping&&!this.jumpDescending?(t.drawImage(wt,0,0,2*C.imgSize,2*C.imgSize,C.deadLocationX-C.width,C.deadLocationY-C.height,2*C.width,2*C.height),t.drawImage(ft,0,0,2*C.imgSize,2*C.imgSize,Math.floor(C.x-C.width)+Math.floor(C.deadAnimationCounter/2),C.y-C.height+C.deadAnimationCounter,2*C.width,2*C.height)):this.jumping&&this.jumpDescending?(t.drawImage(wt,0,0,2*C.imgSize,2*C.imgSize,C.deadLocationX-C.width/2,C.deadLocationY-C.height/2,2*C.width,2*C.height),t.drawImage(ft,0,0,2*C.imgSize,2*C.imgSize,Math.floor(C.x-C.width)+C.deadAnimationCounter/2,C.y-Math.floor(C.height/2)+C.deadAnimationCounter,2*C.width,2*C.height)):(t.drawImage(wt,0,0,2*C.imgSize,2*C.imgSize,C.deadLocationX,C.deadLocationY,2*C.width,2*C.height),t.drawImage(ft,0,0,2*C.imgSize,2*C.imgSize,C.x-C.width/2-C.deadAnimationCounter/2,C.y-C.height/2,2*C.width,2*C.height))),(!P.display||P.timer>=60)&&M.draw(t);else if(this.walking)switch(this.walkPhase){case 1:case 2:t.drawImage(gt,16,16,C.imgSize,C.imgSize,C.x,C.y,C.width,C.height);break;case 4:case 5:t.drawImage(gt,32,0,C.imgSize,C.imgSize,C.x,C.y,C.width,C.height);break;default:t.drawImage(gt,0,0,C.imgSize,C.imgSize,C.x,C.y+e.height/80,C.width,C.height)}else if(this.flying){let i;switch(this.flyingPhase){case 0:i=lt;break;case 1:i=at;break;case 2:i=yt;break;case 3:i=ct}t.drawImage(i,0,0,2*C.imgSize,C.imgSize,1+C.x-C.width,C.y,2*C.width,C.height)}else this.jumping&&t.drawImage(gt,0,32,C.imgSize,C.imgSize,C.x,C.y,C.width,C.height)},keyListener:function(t){49!=t.keyCode&&" "!=t.key&&"Space"!=t.code||(C.dead?C.reset():C.jumping||C.flying?C.jumping&&!C.flying?(C.jumping=!1,C.flying=!0):C.flying&&(C.flying=!1,C.jumping=!0,C.jumpDescending=!0,C.usedRocket=!0):(C.walking=!1,C.jumping=!0,C.midAir=!0))},clickListener:function(t){if(t.preventDefault(),t.stopPropagation(),jt(j,t.offsetX,t.offsetY)&&Q&&U)if(C.dead){jt(M,t.offsetX,t.offsetY)&&(0==P.display||P.timer>=60)&&C.reset()}else C.jumping||C.flying?C.jumping&&!C.flying?(C.jumping=!1,C.flying=!0):C.flying&&(C.flying=!1,C.jumping=!0,C.jumpDescending=!0):(C.walking=!1,C.jumping=!0,C.midAir=!0)},touchListener:function(t){if(jt(j,t.offsetX,t.offsetY)&&Q&&U)if(C.dead){jt(M,t.offsetX,t.offsetY)&&(0==P.display||P.timer>=60)&&C.reset()}else C.jumping||C.flying?C.jumping&&!C.flying?(C.jumping=!1,C.flying=!0):C.flying&&(C.flying=!1,C.jumping=!0,C.jumpDescending=!0):(C.walking=!1,C.jumping=!0,C.midAir=!0)}},T={imgSize:16,y:y.y,width:e.height-y.y,height:e.height-y.y,animationCounter:0,moonArray:[{x:0*(e.height-y.y),sx:0,sy:2},{x:1*(e.height-y.y),sx:1,sy:3},{x:2*(e.height-y.y),sx:2,sy:2},{x:3*(e.height-y.y),sx:3,sy:1},{x:4*(e.height-y.y),sx:4,sy:0},{x:5*(e.height-y.y),sx:5,sy:1},{x:6*(e.height-y.y),sx:6,sy:0},{x:7*(e.height-y.y),sx:7,sy:2},{x:8*(e.height-y.y),sx:3,sy:3},{x:9*(e.height-y.y),sx:6,sy:1},{x:10*(e.height-y.y),sx:2,sy:0},{x:11*(e.height-y.y),sx:3,sy:1},{x:12*(e.height-y.y),sx:0,sy:2},{x:13*(e.height-y.y),sx:1,sy:0},{x:14*(e.height-y.y),sx:2,sy:2},{x:15*(e.height-y.y),sx:4,sy:2},{x:16*(e.height-y.y),sx:5,sy:1},{x:17*(e.height-y.y),sx:6,sy:0},{x:18*(e.height-y.y),sx:1,sy:2},{x:19*(e.height-y.y),sx:0,sy:3},{x:20*(e.height-y.y),sx:4,sy:1},{x:21*(e.height-y.y),sx:6,sy:2},{x:22*(e.height-y.y),sx:4,sy:3},{x:23*(e.height-y.y),sx:2,sy:2},{x:24*(e.height-y.y),sx:1,sy:0},{x:25*(e.height-y.y),sx:2,sy:2},{x:26*(e.height-y.y),sx:2,sy:0},{x:27*(e.height-y.y),sx:2,sy:3}],resize:function(){this.y=y.y,this.width=e.height-y.y,this.height=e.height-y.y;for(let t=0;t<this.moonArray.length;t++)this.moonArray[t].x=this.moonArray[t].x*s},update:function(){if(C.walking||C.jumping||C.flying){for(let t=0;t<this.moonArray.length;t++)this.moonArray[t].x=this.moonArray[t].x-Math.ceil(V/10*(st/75)/2)*d;for(let t=0;t<this.moonArray.length;t++)this.moonArray[t].x+this.width<0&&(this.moonArray[t].x=e.width+this.width,this.moonArray[t].sx=Ct(8),this.moonArray[t].sy=Ct(4))}},draw:function(t){for(let i=0;i<this.moonArray.length;i++)t.drawImage(pt,16*T.moonArray[i].sx,16*T.moonArray[i].sy,T.imgSize,T.imgSize,Math.floor(T.moonArray[i].x),Math.floor(T.y),Math.floor(T.width),Math.floor(T.height))}},Y={imgSizeX:16,imgSizeY:16,y:e.height/12,width:2*V,height:2*V,animationCounter:0,starsArray:[{x:e.width/12*2,y:e.height/12+Ct(48)*(e.height/50),sx:0,sy:0},{x:e.width/12*3,y:e.height/12+Ct(48)*(e.height/50),sx:1,sy:1},{x:e.width/12*4,y:e.height/12+Ct(48)*(e.height/50),sx:2,sy:2},{x:e.width/12*7,y:e.height/12+Ct(48)*(e.height/50),sx:3,sy:3},{x:e.width/12*6,y:e.height/12+Ct(48)*(e.height/50),sx:4,sy:3},{x:e.width/12*9,y:e.height/12+Ct(48)*(e.height/50),sx:5,sy:4},{x:e.width/12*10,y:e.height/12+Ct(48)*(e.height/50),sx:1,sy:5},{x:e.width/12*14,y:e.height/12+Ct(48)*(e.height/50),sx:2,sy:0}],resize:function(){this.y=e.height/12+e.height/12,this.width=2*V,this.height=2*V;for(let t=0;t<this.starsArray.length;t++)this.starsArray[t].x=this.starsArray[t].x*s,this.starsArray[t].y=this.starsArray[t].y*s},update:function(){if(this.animationCounter++,(C.walking||C.jumping||C.flying)&&this.animationCounter>=2){for(let t=0;t<this.starsArray.length;t++)this.starsArray[t].x=this.starsArray[t].x-V/5*(st/80/3)*d;for(let t=0;t<this.starsArray.length;t++)this.starsArray[t].x+this.width<0&&(this.starsArray[t].x=e.width+this.width+(Ct(40)*(e.width/100)+e.width/12),this.starsArray[t].y=e.height/12+Ct(48)*(e.height/50),this.starsArray[t].sx=Ct(6),this.starsArray[t].sy=Ct(6));this.animationCounter=0}},draw:function(t){for(let i=0;i<this.starsArray.length;i++)t.drawImage(vt,Y.starsArray[i].sx*Y.imgSizeX,Y.starsArray[i].sy*Y.imgSizeY,Y.imgSizeX,Y.imgSizeY,Math.ceil(Y.starsArray[i].x),Math.ceil(Y.starsArray[i].y),Math.ceil(Y.width),Math.ceil(Y.height))}},W={imgSize:32,y:e.height/12,width:[(e.height-e.height/12)/6,(e.height-e.height/12)/6],height:[(e.height-e.height/12)/6,(e.height-e.height/12)/6],scoreAdded:[!1,!1],missingAsteroids:[0,5],asteroidsArray:[[{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*0,img:0,missing:!0},{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*1,img:1,missing:!1},{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*2,img:3,missing:!1},{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*3,img:2,missing:!1},{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*4,img:1,missing:!1},{x:e.width/8*8+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*5,img:0,missing:!1}],[{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*0,img:1,missing:!1},{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*1,img:0,missing:!1},{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*2,img:3,missing:!1},{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*3,img:0,missing:!1},{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*4,img:2,missing:!1},{x:e.width/8*13+Ct(6)*(e.width/6)/6,y:e.height/12+(e.height-e.height/12)/6*5,img:2,missing:!0}]],resize:function(){this.y=e.height/12;for(let t=0;t<this.asteroidsArray.length;t++){this.width[t]=(e.height-e.height/12)/this.asteroidsArray[t].length,this.height[t]=(e.height-e.height/12)/this.asteroidsArray[t].length;for(let i=0;i<this.asteroidsArray[t].length;i++)this.asteroidsArray[t][i].x=this.asteroidsArray[t][i].x*s,this.asteroidsArray[t][i].y=this.asteroidsArray[t][i].y*s}},reset:function(){let t=0;for(let i=0;i<this.asteroidsArray.length;i++){this.width[i]=(e.height-e.height/12)/6,this.height[i]=(e.height-e.height/12)/6,this.scoreAdded[i]=!1;for(let t=0;t<this.asteroidsArray[i].length;t++)1==this.asteroidsArray[i][t].missing&&(this.missingAsteroids[i]=t);let h,s=!0;for(;s;){h=Ct(this.asteroidsArray[i].length);let t=0;for(let i=0;i<this.missingAsteroids.length;i++)h==this.missingAsteroids[i]&&t++;0==t&&(s=!1)}for(let s=0;s<this.asteroidsArray[i].length;s++)this.asteroidsArray[i][s].x=(8+t)*(e.width/8)+Ct(this.asteroidsArray[i].length)*(e.width/this.asteroidsArray[i].length/this.asteroidsArray[i].length),this.asteroidsArray[i][s].y=e.height/12+s*this.height[i],this.asteroidsArray[i][s].img=Ct(4),this.asteroidsArray[i][s].missing=h==s;this.scoreAdded[i]=!1,t+=5}},update:function(){if(C.walking||C.jumping||C.flying){for(let t=0;t<this.asteroidsArray.length;t++)for(let i=0;i<this.asteroidsArray[t].length;i++)this.asteroidsArray[t][i].x=this.asteroidsArray[t][i].x-Math.ceil(V/10*(st/75*(1.4+J/300))*d);for(let t=0;t<this.asteroidsArray.length;t++){let i=0;for(let e=0;e<this.asteroidsArray[t].length;e++)this.asteroidsArray[t][e].x+this.width[t]<0&&i++;if(i==this.asteroidsArray[t].length){for(let i=0;i<this.asteroidsArray[t].length;i++)1==this.asteroidsArray[t][i].missing&&(this.missingAsteroids[t]=i);let i,h=!0;for(;h;){i=Ct(this.asteroidsArray[t].length);let e=0;for(let t=0;t<this.missingAsteroids.length;t++)i==this.missingAsteroids[t]&&e++;0==e&&(h=!1)}this.missingAsteroids[t]=i;for(let h=0;h<this.asteroidsArray[t].length;h++)this.asteroidsArray[t][h].x+this.width[t]<0&&(this.asteroidsArray[t][h].x=e.width/8*8+Ct(this.asteroidsArray[t].length)*(e.width/this.asteroidsArray[t].length/this.asteroidsArray[t].length),this.asteroidsArray[t][h].y=e.height/12+h*this.height[t],this.asteroidsArray[t][h].sx=Ct(2),this.asteroidsArray[t][h].sy=Ct(2),this.asteroidsArray[t][h].missing=i==h);this.scoreAdded[t]=!1}}}},draw:function(t){for(let i=0;i<this.asteroidsArray.length;i++)for(let e=0;e<this.asteroidsArray[i].length;e++)W.asteroidsArray[i][e].missing||t.drawImage(At[W.asteroidsArray[i][e].img],0,0,W.imgSize,W.imgSize,Math.floor(W.asteroidsArray[i][e].x),Math.floor(W.asteroidsArray[i][e].y),Math.floor(W.width[i]),Math.floor(W.height[i]))},updateScore:function(){for(let t=0;t<this.asteroidsArray.length;t++){let i=0;for(let e=0;e<this.asteroidsArray[t].length;e++)this.asteroidsArray[t][e].x+this.width[t]<C.x&&i++;i==this.asteroidsArray[t].length&&0==this.scoreAdded[t]&&(J++,Z<J&&(Z=J),this.scoreAdded[t]=!0)}},checkCollides:function(){for(let t=0;t<this.asteroidsArray.length;t++)for(let i=0;i<this.asteroidsArray[t].length;i++)0==this.asteroidsArray[t][i].missing&&C.x+C.width>=this.asteroidsArray[t][i].x+this.width[t]/4&&C.x<=this.asteroidsArray[t][i].x+this.width[t]-this.width[t]/4&&C.y+C.height>=this.asteroidsArray[t][i].y+this.height[t]/4&&C.y<=this.asteroidsArray[t][i].y+this.height[t]-this.height[t]/4&&(C.dead=!0,C.deadLocationX=C.x,C.deadLocationY=C.y,J>5&&St(!0,et,J))}},I={color:"white",hoverColor:"orange",x:e.width/12*8,y:e.height/12/12*2,width:e.width/12*3,height:e.height/12/12*8,hover:!1,resize:function(){this.x=e.width/12*8,this.y=e.height/12/12*2,this.width=e.width/12*3,this.height=e.height/12/12*8},draw:function(t){if(!C.dead){let i;i=I.hover?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="1",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,this.width/3.1415),t.stroke(),zt(this,"Menu / Pause",.6*this.height,"Silkscreen",i)}},clickListener:function(t){let i=jt(I,t.offsetX,t.offsetY);i&&(C.dead||(Q=!1,i=!1,_=!0,I.hover=!1))},keyListener:function(t){27!=t.keyCode&&"Escape"!=t.code||C.dead||(Q=!1,_=!0,I.hover=!1)}},P={color:"white",x:e.width/12*3,y:e.height/12*2,width:e.width/12*6,height:e.height/12*5,display:!1,timer:0,resize:function(){this.x=e.width/12*3,this.y=e.height/12*2,this.width=e.width/12*6,this.height=e.height/12*5},draw:function(t){if(this.display&&C.dead){this.timer<=60&&(this.timer+=1*d),t.fillStyle="black",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.fill(),t.lineWidth=1,t.strokeStyle=this.color,t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),t.font=this.height/3*.5+"px Silkscreen",t.strokeStyle="orange",t.lineWidth=this.height/3*.05,t.beginPath(),t.strokeText("New High Score!",this.x+this.width/2,this.y+this.height/12*2),t.fillStyle="white",t.fillText("New High Score!",this.x+this.width/2,this.y+this.height/12*2),t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*2,this.y+this.height/12*2.5),t.lineTo(this.x+this.width/12*10,this.y+this.height/12*2.5),t.stroke();let i,e=this.x+this.width/12*1,h=(this.x+this.width/12*11-e)/3,s=this.y+5*this.height/12,o=(this.y+this.height-s)/10;for(let r=0;r<3;r++){switch(r){case 0:i="Place";break;case 1:i="Name";break;case 2:i="Score"}t.strokeStyle="white",t.font=1.7*o+"px Silkscreen",t.fillStyle="white",t.fillText(i,e+r*h+h/4+r*(h/4),s-o/2)}t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*.5,s),t.lineTo(this.x+this.width/12*11.5,s),t.stroke(),t.strokeStyle="white",t.font=1.7*o+"px Silkscreen",t.fillStyle="white",t.fillText(D,e+0*h+h/4,s+1.5*o),t.strokeStyle="white",t.font=1.7*o+"px Silkscreen",t.fillStyle="white",t.fillText(et,e+1*h+h/4+h/4*1,s+1.5*o),t.strokeStyle="white",t.font=1.7*o+"px Silkscreen",t.fillStyle="white",t.fillText(J,e+2*h+h/4+h/4*2,s+1.5*o),t.strokeStyle="gray",t.lineWidth=2,t.beginPath(),t.moveTo(this.x+this.width/12*.5,s+2*o),t.lineTo(this.x+this.width/12*11.5,s+2*o),t.stroke()}}},M={color:"white",hoverColor:"orange",x:e.width/12*4,y:e.height/12*8,width:e.width/12*4,height:e.height/12*2,hover:!1,resize:function(){this.x=e.width/12*4,this.y=e.height/12*8,this.width=e.width/12*4,this.height=e.height/12*2,C.deadLocationX=8*V,C.deadLocationY=C.deadLocationY*s},draw:function(t){let i;i=M.hover?this.hoverColor:this.color,t.strokeStyle=i,t.lineWidth="1",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,this.width/3.1415),t.stroke(),zt(this,"Restart",.5*this.height,"Silkscreen",i)}},B=function(t){let i=jt(I,t.offsetX,t.offsetY);if(C.dead||(I.hover=!!i),C.dead&&C.deadAnimationCounter>60){let i=jt(M,t.offsetX,t.offsetY);M.hover=!!i}},q.push(I.keyListener,I.clickListener,C.keyListener,C.clickListener,C.touchListener),G.splice(0,0,Y,l,z,I,y,T,W,C,P,m),Q=!0}function Mt(){Q?(document.removeEventListener("keydown",O[0]),e.removeEventListener("click",O[1]),e.removeEventListener("click",O[2]),e.removeEventListener("click",O[3]),g.removeEventListener("keydown",O[4]),e.removeEventListener("click",O[5]),e.removeEventListener("click",O[6]),e.removeEventListener("mousemove",R),document.addEventListener("keydown",q[0]),e.addEventListener("mousedown",q[1],!0),document.addEventListener("keydown",q[2]),e.addEventListener("mousedown",q[3],!0),e.addEventListener("touchstart",q[4],{passive:!0}),e.addEventListener("mousemove",B)):(U&&(document.removeEventListener("keydown",q[0]),e.removeEventListener("mousedown",q[1]),document.removeEventListener("keydown",q[2]),e.removeEventListener("mousedown",q[3]),e.removeEventListener("touchstart",q[4]),e.removeEventListener("mousemove",B)),document.addEventListener("keydown",O[0]),e.addEventListener("click",O[1]),e.addEventListener("click",O[2]),e.addEventListener("click",O[3]),g.addEventListener("keydown",O[4],!0),e.addEventListener("click",O[5]),e.addEventListener("click",O[6]),e.addEventListener("mousemove",R)),_=!1}function Tt(){o=1e3/K,n=performance.now(),requestAnimationFrame(Yt)}function Yt(){requestAnimationFrame(Yt),r=performance.now(),d=(r-n)/o,n=r,it||k.record(d),Q?(C.update(),W.update(),T.update(),Y.update(),_&&Mt(),C.dead||(W.checkCollides(),W.updateScore())):(p.update(),tt&&bt(),_&&Mt()),function(t){if(t.clearRect(0,0,e.width,e.height),Q)for(let i=0;i<G.length;i++)G[i].draw(t);else for(let i=0;i<N.length;i++)N[i].draw(t)}(h)}k={fpsArray:[],currentFps:0,lowFpsCount:0,record:function(t){if(this.fpsArray.push(t),60==this.fpsArray.length){let t=0,i=0;for(let i=0;i<this.fpsArray.length;i++)t+=this.fpsArray[i];i=Math.floor(6/(t/10)*60),i<45?this.lowFpsCount++:this.lowFpsCount=0,this.currentFps=i,this.fpsArray.splice(0,60),2!=this.lowFpsCount||it||(it=!0)}}},window.onload=function(){e=document.getElementById("board"),h=e.getContext("2d"),Et(),g=document.getElementById("hiddenInput"),gt=document.getElementById("cat-1-img"),lt=document.getElementById("cat-1-flying-1-img"),at=document.getElementById("cat-1-flying-2-img"),yt=document.getElementById("cat-1-flying-3-img"),ct=document.getElementById("cat-1-flying-4-img"),ft=document.getElementById("cat-1-dead-img"),wt=document.getElementById("blood-1-img"),mt=document.getElementById("asteroid-1-img"),ut=document.getElementById("asteroid-2-img"),xt=document.getElementById("asteroid-3-img"),kt=document.getElementById("asteroid-4-img"),At[0]=mt,At[1]=ut,At[2]=xt,At[3]=kt,pt=document.getElementById("moon-1-img"),vt=document.getElementById("stars-1-img"),It()};